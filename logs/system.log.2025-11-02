ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 92, in update_csv_files
    price_old = load_existing(f"{self.DATA_PATH}/price_daily.csv")
TypeError: load_existing() missing 1 required positional argument: 'path'
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 92, in update_csv_files
    price_old = load_existing(f"{self.DATA_PATH}/price_daily.csv")
TypeError: load_existing() missing 1 required positional argument: 'path'
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (88 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚úÖ Loaded existing file: data/raw/news_sentiment.csv (796 rows)
‚úÖ Loaded existing file: data/raw/macro_index.csv (66 rows)
Fetching latest prices & fundamentals...
Merging new data with old datasets...
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 129, in update_csv_files
    price_all = merge_new(price_old, price_new, ["stock_id", "date"]) if price_new is not None else price_old
TypeError: merge_new() missing 1 required positional argument: 'key_cols'
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (88 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚úÖ Loaded existing file: data/raw/news_sentiment.csv (796 rows)
‚úÖ Loaded existing file: data/raw/macro_index.csv (66 rows)
Fetching latest prices & fundamentals...
Merging new data with old datasets...
‚úÖ Merged data ‚Äî now 88 rows after deduplication.
‚úÖ Merged data ‚Äî now 46 rows after deduplication.
Saving merged data to CSV files...
‚úÖ All datasets updated successfully for 2025-11-02
===== Update process finished =====

ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚ùå Error loading file: data/raw/price_daily.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/fundamentals_quarterly.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/news_sentiment.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/macro_index.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
Fetching latest prices & fundamentals...
Merging new data with old datasets...
‚ö†Ô∏è Old dataset empty, returning new data only.
‚ö†Ô∏è Old dataset empty, returning new data only.
Saving merged data to CSV files...
‚úÖ All datasets updated successfully for 2025-11-02
===== Update process finished =====

ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (84 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (21 rows)
‚ùå Error loading file: data/raw/news_sentiment.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/macro_index.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
Fetching latest prices & fundamentals...
Merging new data with old datasets...
‚úÖ Merged data ‚Äî now 84 rows after deduplication.
‚úÖ Merged data ‚Äî now 25 rows after deduplication.
Saving merged data to CSV files...
‚úÖ All datasets updated successfully for 2025-11-02
===== Update process finished =====

‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (84 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚ùå Error loading file: data/raw/news_sentiment.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/macro_index.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 98, in update_csv_files
    df = pd.read_csv("https://datahub.io/core/russell-1000/r/russell-1000.csv")
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 728, in get_handle
    ioargs = _get_filepath_or_buffer(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 384, in _get_filepath_or_buffer
    with urlopen(req_info) as req:
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 289, in urlopen
    return urllib.request.urlopen(*args, **kwargs)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 525, in open
    response = meth(req, response)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 634, in http_response
    response = self.parent.error(
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 563, in error
    return self._call_chain(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 643, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found
‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (84 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚ùå Error loading file: data/raw/news_sentiment.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/macro_index.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 99, in update_csv_files
    df = pd.read_csv("https://raw.githubusercontent.com/datasets/russell-1000/master/data/russell-1000.csv")
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 728, in get_handle
    ioargs = _get_filepath_or_buffer(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 384, in _get_filepath_or_buffer
    with urlopen(req_info) as req:
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 289, in urlopen
    return urllib.request.urlopen(*args, **kwargs)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 525, in open
    response = meth(req, response)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 634, in http_response
    response = self.parent.error(
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 563, in error
    return self._call_chain(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 643, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 101, in update_csv_files
    self.logger.warning(f"‚ö†Ô∏è Primary Russell 1000 source failed ({e}), switching to Wikipedia backup.")
AttributeError: 'StatusLogger' object has no attribute 'warning'
‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (84 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚ùå Error loading file: data/raw/news_sentiment.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/macro_index.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ö†Ô∏è Primary Russell 1000 source failed (HTTP Error 404: Not Found), switching to Wikipedia backup.
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 99, in update_csv_files
    df = pd.read_csv("https://raw.githubusercontent.com/datasets/russell-1000/master/data/russell-1000.csv")
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 728, in get_handle
    ioargs = _get_filepath_or_buffer(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 384, in _get_filepath_or_buffer
    with urlopen(req_info) as req:
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 289, in urlopen
    return urllib.request.urlopen(*args, **kwargs)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 525, in open
    response = meth(req, response)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 634, in http_response
    response = self.parent.error(
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 563, in error
    return self._call_chain(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 643, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 992, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1004, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'lxml'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 102, in update_csv_files
    df = pd.read_html("https://en.wikipedia.org/wiki/Russell_1000_Index")[1]
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/html.py", line 1240, in read_html
    return _parse(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/html.py", line 971, in _parse
    parser = _parser_dispatch(flav)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/html.py", line 918, in _parser_dispatch
    import_optional_dependency("lxml.etree")
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'lxml'.  Use pip or conda to install lxml.
‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (84 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚ùå Error loading file: data/raw/news_sentiment.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/macro_index.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 43, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ö†Ô∏è Primary Russell 1000 source failed (HTTP Error 404: Not Found), switching to Wikipedia backup.
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 99, in update_csv_files
    df = pd.read_csv("https://raw.githubusercontent.com/datasets/russell-1000/master/data/russell-1000.csv")
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 728, in get_handle
    ioargs = _get_filepath_or_buffer(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 384, in _get_filepath_or_buffer
    with urlopen(req_info) as req:
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 289, in urlopen
    return urllib.request.urlopen(*args, **kwargs)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 525, in open
    response = meth(req, response)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 634, in http_response
    response = self.parent.error(
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 563, in error
    return self._call_chain(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 643, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 102, in update_csv_files
    df = pd.read_html("https://en.wikipedia.org/wiki/Russell_1000_Index")[1]
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/html.py", line 1240, in read_html
    return _parse(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/html.py", line 983, in _parse
    tables = p.parse_tables()
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/html.py", line 249, in parse_tables
    tables = self._parse_tables(self._build_doc(), self.match, self.attrs)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/html.py", line 806, in _build_doc
    raise e
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/html.py", line 785, in _build_doc
    with get_handle(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 728, in get_handle
    ioargs = _get_filepath_or_buffer(
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 384, in _get_filepath_or_buffer
    with urlopen(req_info) as req:
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/common.py", line 289, in urlopen
    return urllib.request.urlopen(*args, **kwargs)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 525, in open
    response = meth(req, response)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 634, in http_response
    response = self.parent.error(
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 563, in error
    return self._call_chain(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/opt/homebrew/Cellar/python@3.10/3.10.17/Frameworks/Python.framework/Versions/3.10/lib/python3.10/urllib/request.py", line 643, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 403: Forbidden
‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (84 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚ùå Error loading file: data/raw/news_sentiment.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 58, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ùå Error loading file: data/raw/macro_index.csv
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 58, in load_existing
    cols = pd.read_csv(path, nrows=0).columns
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/Users/jju/Library/Caches/pypoetry/virtualenvs/stock-ml-CDODyAIP-py3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
‚ö†Ô∏è Unable to fetch from FMP, 
Fetching latest prices & fundamentals...
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 122, in update_csv_files
    price_new, fund_new = fetch_prices(tickers, self.START_DATE, self.TODAY)
UnboundLocalError: local variable 'tickers' referenced before assignment
‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (84 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚ùå Error loading file: data/raw/news_sentiment.csv (No columns to parse from file)
‚ùå Error loading file: data/raw/macro_index.csv (No columns to parse from file)
‚ö†Ô∏è Unable to fetch from FMP, 
Fetching latest prices & fundamentals...
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 128, in update_csv_files
    price_new, fund_new = fetch_prices(tickers, self.START_DATE, self.TODAY)
UnboundLocalError: local variable 'tickers' referenced before assignment
‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (84 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (25 rows)
‚ùå Error loading file: data/raw/news_sentiment.csv (No columns to parse from file)
‚ùå Error loading file: data/raw/macro_index.csv (No columns to parse from file)
Fetching latest prices & fundamentals...
Fetching news sentiment data...
Fetching macro indices data...
Merging new data with old datasets...
‚úÖ Merged data ‚Äî now 1176 rows after deduplication.
‚úÖ Merged data ‚Äî now 343 rows after deduplication.
‚ö†Ô∏è Old dataset empty, returning new data only.
‚ö†Ô∏è Old dataset empty, returning new data only.
Saving merged data to CSV files...
‚úÖ All datasets updated successfully for 2025-11-02
===== Update process finished =====

‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (1176 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (343 rows)
‚úÖ Loaded existing file: data/raw/news_sentiment.csv (4030 rows)
‚úÖ Loaded existing file: data/raw/macro_index.csv (63 rows)
‚ùå Unexpected error during update process
Traceback (most recent call last):
  File "/Users/jju/Documents/Stock ML/src/core/db_updater_utils.py", line 120, in update_csv_files
    with open("../config.yaml", "r") as f:
FileNotFoundError: [Errno 2] No such file or directory: '../config.yaml'
‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (1176 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (343 rows)
‚úÖ Loaded existing file: data/raw/news_sentiment.csv (4030 rows)
‚úÖ Loaded existing file: data/raw/macro_index.csv (63 rows)
Loaded 61 tickers
Fetching latest prices & fundamentals...
Fetching news sentiment data...
Fetching macro indices data...
Merging new data with old datasets...
‚úÖ Merged data ‚Äî now 1176 rows after deduplication.
‚úÖ Merged data ‚Äî now 661 rows after deduplication.
‚úÖ Merged data ‚Äî now 6721 rows after deduplication.
‚úÖ Merged data ‚Äî now 63 rows after deduplication.
Saving merged data to CSV files...
‚úÖ All datasets updated successfully for 2025-11-02
===== Update process finished =====

‚úÖ /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv ‚Üí fundamentals_q_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: fundamentals_q_full in /Users/jju/Documents/Stock ML/data/raw/fundamentals_quarterly.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/macro_index.csv ‚Üí macro_index_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: macro_index_full in /Users/jju/Documents/Stock ML/data/raw/macro_index.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv ‚Üí news_sentiment Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: news_sentiment in /Users/jju/Documents/Stock ML/data/raw/news_sentiment.csv
‚úÖ /Users/jju/Documents/Stock ML/data/raw/price_daily.csv ‚Üí price_daily_full Ï†ÄÏû• ÏôÑÎ£å
LOADING COMPLETED: price_daily_full in /Users/jju/Documents/Stock ML/data/raw/price_daily.csv
Done!
ü¶Ü Connected to DuckDB at /Users/jju/Documents/Stock ML/src/db/stockml.duckdb
üîÑ Updating data...
===== Update process started =====
‚úÖ Loaded existing file: data/raw/price_daily.csv (1176 rows)
‚úÖ Loaded existing file: data/raw/fundamentals_quarterly.csv (661 rows)
‚úÖ Loaded existing file: data/raw/news_sentiment.csv (6721 rows)
‚úÖ Loaded existing file: data/raw/macro_index.csv (63 rows)
Loaded 61 tickers
Fetching latest prices & fundamentals...
